var githubSVG = '<g transform="translate(0.000000,500.000000) scale(0.100000,-0.100000)" stroke="none"><path d="M2314 4070 c-624 -79 -1138 -503 -1327 -1095 -99 -310 -96 -676 7 -983 123 -363 394 -690 723 -873 108 -60 273 -129 307 -129 13 0 35 9 50 21 l26 20 0 162 0 162 -147 1 c-126 1 -156 4 -204 23 -89 34 -132 78 -194 200 -53 105 -81 139 -185 230 -40 35 -43 41 -30 56 11 13 26 16 65 13 92 -8 170 -62 249 -171 91 -128 155 -163 288 -154 92 6 158 22 162 40 15 63 43 129 68 160 16 21 28 40 27 42 -2 2 -49 11 -104 20 -212 36 -397 141 -481 272 -83 130 -124 287 -125 473 0 94 5 135 22 192 23 79 66 164 106 212 23 27 24 35 17 76 -5 25 -9 97 -8 160 1 140 24 223 63 228 55 8 251 -66 357 -133 50 -32 59 -35 87 -26 157 52 567 52 724 0 28 -9 37 -6 88 26 109 70 295 140 353 133 21 -2 29 -13 44 -58 26 -74 34 -213 18 -301 l-13 -68 29 -41 c54 -76 73 -115 100 -200 24 -79 26 -94 21 -230 -5 -165 -24 -252 -82 -374 -81 -171 -259 -290 -508 -337 -62 -12 -114 -23 -116 -25 -3 -2 5 -14 16 -27 68 -74 83 -158 83 -480 l0 -248 25 -24 c33 -34 59 -32 170 14 307 126 546 322 733 602 304 454 342 1067 96 1561 -222 447 -618 754 -1103 854 -140 29 -370 40 -497 24z"/></g>'
var webSVG = `<g transform="translate(0.000000,300.000000) scale(0.100000,-0.100000)" stroke="none"><path d="M1265 2416 c-167 -44 -293 -115 -422 -239 -132 -127 -214 -268 -260 -447 -35 -136 -35 -324 0 -460 46 -179 117 -301 251 -436 190 -190 395 -275 661 -276 271 -1 479 85 671 276 189 190 275 399 276 666 0 265 -88 479 -276 666 -135 135 -258 205 -435 250 -132 34 -335 34 -466 0z m-126 -233 c-37 -47 -118 -123 -130 -123 -8 0 -20 4 -27 9 -10 6 6 22 55 58 62 46 102 72 112 73 2 0 -3 -8 -10 -17z m713 -8 c16 -19 29 -24 48 -20 20 4 39 -6 90 -48 164 -134 267 -324 285 -532 6 -67 6 -69 -9 -42 -9 16 -26 37 -38 48 -23 19 -155 89 -169 89 -17 0 27 -61 48 -66 12 -3 30 -15 40 -26 17 -19 17 -20 -7 -39 -82 -66 -124 -76 -141 -31 -6 15 -33 60 -61 101 -46 67 -51 79 -49 123 2 49 -5 58 -28 36 -10 -11 -17 -7 -37 17 -13 17 -24 37 -24 47 0 23 53 39 106 31 35 -5 44 -3 44 9 0 9 -11 23 -25 32 -14 9 -23 21 -20 27 12 19 -27 21 -65 4 -26 -12 -42 -27 -49 -46 -5 -16 -14 -29 -18 -30 -56 -8 -76 -5 -80 10 -3 13 -58 52 -95 69 -18 8 -6 -25 18 -51 36 -39 24 -45 -17 -8 -18 17 -44 31 -57 31 -35 0 -94 -36 -117 -71 -17 -26 -25 -29 -60 -27 -39 3 -40 4 -43 44 -3 40 -2 42 31 48 40 7 70 36 61 59 -4 11 7 23 43 41 26 15 60 36 74 47 l27 21 31 -23 c26 -19 34 -21 56 -11 26 12 34 52 16 81 -7 11 -13 8 -26 -13 -22 -33 -48 -33 -64 0 -8 19 -17 25 -31 21 -23 -6 -27 15 -6 32 32 26 95 40 194 40 97 1 103 0 124 -24z m-448 -104 c27 -29 28 -29 8 -40 -39 -21 -52 -14 -52 29 0 22 4 40 8 40 5 0 21 -13 36 -29z m-64 -30 c0 -6 -4 -13 -10 -16 -5 -3 -10 1 -10 9 0 9 5 16 10 16 6 0 10 -4 10 -9z m-474 -138 c6 -23 1 -32 -39 -66 -26 -21 -47 -43 -47 -49 0 -5 5 -6 10 -3 15 9 12 0 -11 -40 -12 -20 -24 -34 -26 -31 -13 13 79 216 98 216 5 0 12 -12 15 -27z m671 -113 c14 0 24 -9 32 -30 13 -38 51 -54 113 -46 58 8 171 -26 191 -58 8 -11 27 -53 44 -92 41 -98 91 -165 121 -160 33 5 27 -17 -21 -76 -73 -90 -80 -104 -78 -162 1 -49 -2 -58 -39 -102 -22 -27 -40 -58 -40 -70 0 -24 -58 -88 -99 -108 -14 -7 -42 -16 -62 -20 -39 -7 -49 3 -49 48 0 25 -25 82 -48 108 -12 15 -13 24 -2 62 15 53 5 123 -20 151 -10 11 -21 44 -25 73 -7 55 -8 56 -40 42 -15 -6 -24 -3 -36 12 -15 19 -18 19 -45 5 -16 -8 -46 -18 -67 -22 -31 -6 -43 -3 -73 20 -19 15 -49 45 -65 68 -25 35 -29 49 -29 109 0 63 3 72 28 97 15 15 34 32 42 37 8 5 28 28 43 52 18 28 34 42 50 42 12 0 42 7 67 15 25 8 54 12 65 10 11 -3 30 -5 42 -5z m-733 -525 c28 -17 52 -42 70 -74 22 -41 36 -54 86 -77 32 -15 61 -33 64 -40 3 -8 -2 -33 -10 -56 -8 -24 -12 -53 -9 -66 8 -33 -21 -40 -52 -11 -52 48 -141 179 -172 252 -31 75 -37 97 -25 97 3 0 25 -11 48 -25z m1236 -199 c-11 -34 -55 -84 -66 -74 -12 12 21 94 45 115 31 26 39 11 21 -41z"/></g>`

var projectChangeAnimationTime = 150;
var currentPageName = '';
var projectsJSON = {};

var pages = {
	'about': {
		'isAbout': true,
	},
	'experience': {
		'isAbout': false,
		'projectSet': ['coursera-full-stack', 'coursera-mobile', 'enflick', 'osc']
	},
	'projects': {
		'isAbout': false,
		'projectSet': ['techtanks', 'ddr-generation', 'army-commander', 'news-feed', 'swipler', 'jarvis', '3d-viewer', 'intoxicmate', 'myoguitar']
	},
	'initiatives': {
		'isAbout': false,
		'projectSet': ['tech-retreat', 'terrible-hack', 'engsoc', 'sipo']
	}
}

function showPage(pageName) {
	if(currentPageName == pageName) return;
	page = pages[pageName];
	$('#page-right').fadeOut(projectChangeAnimationTime);
	$('#navLinks h4').removeClass("active");
	$(`#${pageName}Link`).addClass("active");
	setTimeout(function () {
		if (page.isAbout) {
			$('#about').show();
			$('#projects').hide();
		} else {
			$('#about').hide();
			$('#projects').show();
			$('#projects-table').empty();
			for(var i = 0; i < page.projectSet.length; i++) {
				var project = projectsJSON[page.projectSet[i]];
			  $('#projects-table').append(buildProject(project, i == 0));
			}
		}
		$('#page-right').fadeIn(projectChangeAnimationTime);
	}, projectChangeAnimationTime);
	currentPageName = pageName;
}

$(document).ready(function() {
	showPage('about');
  loadJSON();
});

function loadJSON() {
	var xobj = new XMLHttpRequest();
	xobj.overrideMimeType("application/json");
	xobj.open('GET', 'data/projects.json', true);
	xobj.onreadystatechange = function () {
		if (xobj.readyState == 4 && xobj.status == "200") {
			projectsJSON = JSON.parse(xobj.responseText);
		}
	}
	xobj.send(null);
}

function buildProject(project, first) {
  return $(
		`<div class="project">
			<h3>${project.type? project.name : project.name + ' ' + project.type}</h3>
			<p>${project.description}</p>
			<p>
				${project.technologies ? `<i>${project.technologies}</i>` : ''}
				${project.github ?
				`<a class="bubbleLink" href="${project.github}" target="_blank">
					<svg version="1.0" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 500.000000 500.000000" preserveAspectRatio="xMidYMid meet">
						${githubSVG}
					</svg>
				</a>` : ''}
				${project.web ?
				`<a class="bubbleLink" href="${project.web}" target="_blank">
					<svg version="1.0" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 300.000000 300.000000" preserveAspectRatio="xMidYMid meet">
						${webSVG}
					</svg>
				</a>` : ''}
			</p>
		</div>`);
}
